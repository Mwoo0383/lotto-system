<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¡œë˜ ë‹¹ì²¨ ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" href="/css/lotto.css">
    <style>
        body {
            align-items: center;
        }
        .hero {
            text-align: center;
            padding: 40px 24px;
        }
        .hero-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }
        .hero h1 {
            font-size: 28px;
            margin-bottom: 12px;
        }
        .hero p {
            color: #666;
            font-size: 15px;
            line-height: 1.6;
        }
        .event-card {
            text-align: center;
        }
        .event-card h2 {
            text-align: center;
            color: #4a90d9;
        }
        .event-card .event-period {
            margin: 8px 0 20px;
        }
        .loading {
            text-align: center;
            padding: 20px;
            color: #999;
        }
        .no-event {
            text-align: center;
            padding: 20px;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card hero">
            <div class="hero-icon">ğŸ±</div>
            <h1>ë¡œë˜ ë‹¹ì²¨ ì‹œìŠ¤í…œ</h1>
            <p>í–‰ìš´ì˜ ë¡œë˜ ë²ˆí˜¸ë¥¼ ë°›ì•„ë³´ì„¸ìš”!<br>íœ´ëŒ€í° ì¸ì¦ í›„ ë°”ë¡œ ì°¸ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

        <div id="event-section" class="card event-card">
            <div id="loading" class="loading">ì´ë²¤íŠ¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            <div id="event-detail" class="hidden">
                <h2 id="event-name"></h2>
                <p class="event-period" id="event-period"></p>
                <button class="btn-primary" id="btn-participate" onclick="goParticipate()">ì°¸ê°€í•˜ê¸°</button>
            </div>
            <div id="no-event" class="no-event hidden">
                <p>í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <script>
        let activeEventId = null;

        document.addEventListener('DOMContentLoaded', loadActiveEvent);

        async function loadActiveEvent() {
            try {
                const res = await fetch('/api/event/active');
                const data = await res.json();
                document.getElementById('loading').classList.add('hidden');

                if (data.active) {
                    activeEventId = data.eventId;
                    document.getElementById('event-name').textContent = data.name;
                    document.getElementById('event-period').textContent =
                        data.startAt.replace('T', ' ') + ' ~ ' + data.endAt.replace('T', ' ');
                    document.getElementById('event-detail').classList.remove('hidden');

                    // ìµœì´ˆ ì ‘ì† ì‹œ ìë™ìœ¼ë¡œ ì°¸ê°€ í˜ì´ì§€ ì´ë™
                    if (!sessionStorage.getItem('visited')) {
                        sessionStorage.setItem('visited', 'true');
                        goParticipate();
                    }
                } else {
                    document.getElementById('no-event').classList.remove('hidden');
                }
            } catch (e) {
                document.getElementById('loading').textContent = 'ì´ë²¤íŠ¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
            }
        }

        function goParticipate() {
            if (activeEventId) {
                location.href = '/participate.html?eventId=' + activeEventId;
            }
        }
    </script>
</body>
</html>
